{% extends 'base.html' %}
{% load staticfiles %}
{% block content %}
    <div class="large-9 columns">
        <div class="row main-content-top">
            <div class="large-6 columns">
                <h2 class="top-title"><span class="title-icon"><i
                        class="icon-reorder"></i></span>{{ request_your.title }}</h2>
            </div>
            <div class="large-6 columns">
                <ul class="breadcrumbs right">
                    <li><a href="/">Home</a></li>
                    <li><a href="{% url 'request:view_your' %}">Your Requests</a></li>
                    <li class="current">{{ request_your.title }}</li>
                </ul>
            </div>
        </div>
        <div class="row main-content">
            <div class="large-12 columns">
                <h3 class="color">Request</h3>

                <div class="large-6 columns">
                    <div class="rows">

                        <div class="panel">
                            <strong>Title: </strong>{{ request_your.title }}
                        </div>
                        <div class="panel">
                            <strong>Request: </strong>{{ request_your.request }}
                        </div>
                        <div class="panel">
                            <strong>Due By: </strong>{{ request_your.due_by }}
                        </div>
                        <div class="panel">
                            <strong>Reward: </strong>{{ request_your.reward }}
                        </div>
                        <div class="panel">
                            <strong>Max Reward: </strong>{{ request_your.max_reward }}
                        </div>
                        {% if user == request_your.user %}
                            <a class="button" href="{% url 'request:edit' request_your.id %}">Edit</a>
                        {% elif not have_responded %}
                            <a class="button" href="{% url 'response:create' request_your.id %}">Respond</a>
                        {% endif %}
                    </div>
                </div>
                <div class="large-6 columns" style="margin-top: -50px">
                    <h3 class="color" style="margin-left: -25px">Responses</h3>

                    <div class="rows">
                        {% for response_to in responses %}
                            <div class="panel">
                                <strong>{{ response_to.user.username }} is offering
                                    at: </strong> {{ response_to.price }}
                                <input class="push-6" type="submit" name="strip-token" class="stripe-button-el">Buy</a>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- End Row -->
{% endblock %}
{% block additionalScripts %}
    <script src="//checkout.stripe.com/v2/checkout.js"></script>
    <script>
        $(function () {
            $('body').on("click", '.change-card, .subscribe-form button[type=submit]', function (e) {
                e.preventDefault();
                var $form = $(this).closest("form"),
                        token = function (res) {
                            $form.find("input[name=stripe_token]").val(res.id);
                            $form.trigger("submit");
                        };

                StripeCheckout.open({
                    key: $form.data("stripe-key"),
                    name: 'Payment Method',
                    panelLabel: 'Add Payment Method',
                    token: token
                });

                return false;
            });
        });
    </script>
{% endblock %}
